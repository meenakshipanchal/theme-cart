{% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
{%- if predictive_search.performed -%}
  {% assign first_column_results_size = predictive_search.resources.queries.size
    | plus: predictive_search.resources.collections.size
    | plus: predictive_search.resources.pages.size
    | plus: predictive_search.resources.articles.size
  %}
  <div id="predictive-search-results" class="predictive-search-results" role="listbox">
    {%- if predictive_search.resources.queries.size > 0 -%}
      <div class="predictive-search-suggestions">
        <h2>{{- 'templates.search.suggestions' | t -}}</h2>
        <ul id="predictive-search-results-queries-list" class="predictive-search-results">
          {%- for collection in predictive_search.resources.collections -%}
            <li><a href="{{ collection.url }}" class="predictive-item link--text" tabindex="-1">{{ collection.title | escape }}</a></li>
          {%- endfor -%}
          {%- for query in predictive_search.resources.queries -%}
            <li><a href="{{ query.url }}" class="predictive-item link--text" tabindex="-1">{{ query.styled_text }}</a></li>
          {%- endfor -%}
        </ul>
      </div>
    {%- endif -%}

    {%- if predictive_search.resources.products.size > 0
      or predictive_search.resources.articles.size > 0
    -%}
      {%- if predictive_search.resources.products.size > 0 -%}
        <h2>{{- 'templates.search.products' | t -}}</h2>
        <ul id="predictive-search-results-products-list" class="predictive-product-search">
          {%- for product in predictive_search.resources.products -%}
            {%- unless product.tags contains 'no-sale' -%}
              <li id="predictive-search-option-product-{{ forloop.index }}"
                class="predictive-search__list-item">
                <a href="{{ product.url }}"
                  class="predictive-search_item"
                  tabindex="-1">
                  {%- if product.featured_media != blank -%}
                    <img class="predictive-search__image"
                      src="{{ product.featured_media | image_url: width: 250 }}"
                      alt="{{ product.featured_media.alt | escape }}"
                      width="250"
                      height="{{ 250 | divided_by: product.featured_media.preview_image.aspect_ratio }}">
                  {%- endif -%}
                  <div>
                    <h4>{{ product.title | escape }}</h4>
                    {% render 'judgeme_widgets', widget_type: 'judgeme_preview_badge', jm_style: '', concierge_install: false, product: product %}
                    {%- if settings.predictive_search_show_price -%}
                      {% render 'price', product: product, use_variant: true, show_badges: false %}
                    {%- endif -%}
                  </div>
                </a>
              </li>
            {%- endunless %}
          {%- endfor -%}
        </ul>
      {%- endif -%}
      {%- if predictive_search.resources.articles.size > 0 -%}
        <h2>Blogs</h2>
          <ul class="blog-list">
            {%- for article in predictive_search.resources.articles -%}
              <li>
                <a href="{{ article.url }}" class="predictive-search-blog link link--text" tabindex="-1">
                  <img src="{{ article.image.src | image_url: width: 360 }} 360w" alt="{{ article.title | escape }}" class="predictive-search__image" width="180" height="120" >
                  <h4>{{ article.title | escape }}</h4>
                  </a>
              </li>
            {%- endfor -%}
          </ul>
      {%- endif -%}
    {%- endif -%}
  </div>

  <span class="hidden" data-predictive-search-live-region-count-value>
    {% liquid
      assign total_results = predictive_search.resources.products.size | plus: first_column_results_size
      if total_results == 0
        echo 'templates.search.no_results' | t: terms: predictive_search.terms
      else
        echo 'templates.search.results_with_count' | t: count: total_results | append: ': '
        if predictive_search.resources.queries.size > 0
          assign count = predictive_search.resources.queries.size | plus: predictive_search.resources.collections.size
          echo 'templates.search.results_suggestions_with_count' | t: count: count | append: ', '
        endif
        if predictive_search.resources.pages.size > 0
          assign count = predictive_search.resources.pages.size | plus: predictive_search.resources.articles.size
          echo 'templates.search.results_pages_with_count' | t: count: count | append: ', '
        endif
        if predictive_search.resources.products.size > 0
          echo 'templates.search.results_products_with_count' | t: count: predictive_search.resources.products.size
        endif
      endif
    %}
  </span>
{%- endif -%}
