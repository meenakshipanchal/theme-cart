{% comment %}
  Promotional Banner Component - 3 States
  Usage: {% render 'promo-banner' %}
{% endcomment %}

{% comment %} ============= MANUAL CONTROLS ============= {% endcomment %}
{% assign SHOW_DEFAULT_APP_BANNER = true %}
{% assign SHOW_PRESALE_BANNER = false %}
{% assign SHOW_SITEWIDE_SALE_BANNER = false %}

{% comment %} ============= CONFIGURATION ============= {% endcomment %}
{% assign SALE_ICON_URL = "https://cdn.shopify.com/s/files/1/0270/3346/9006/files/pdp_icon_2.svg?v=1769453365" %}
{% assign APP_LINK = "https://anveshanfarm.page.link/8V2f" %}
{% assign ALL_PRODUCTS_LINK = "/collections/all-products" %}

{% comment %} ============= LOGIC ============= {% endcomment %}
{% assign show_banner_1 = false %}
{% assign show_banner_2 = false %}
{% assign show_banner_3 = false %}

{% if SHOW_SITEWIDE_SALE_BANNER %}
  {% assign show_banner_3 = true %}
{% elsif SHOW_PRESALE_BANNER %}
  {% assign show_banner_2 = true %}
{% elsif SHOW_DEFAULT_APP_BANNER %}
  {% assign show_banner_1 = true %}
{% endif %}

<div class="promo-banner-wrapper">

  {% if show_banner_1 %}
  <a href="{{ APP_LINK }}" target="_blank" rel="noopener" class="promo-banner">
    <p class="promo-banner__line1">Shop on our App & <strong>unlock 17% OFF</strong> (15% + 2% extra on App-only)</p>
    <div class="promo-banner__line2">
      <div class="promo-banner__code-box">Use code: <strong>APP17</strong></div>
      <img src="https://cdn.shopify.com/s/files/1/0270/3346/9006/files/o__1.svg?v=1769183908" alt="Google Play" class="promo-banner__store-img">
      <img src="https://cdn.shopify.com/s/files/1/0270/3346/9006/files/o__1_1.svg?v=1769184051" alt="App Store" class="promo-banner__store-img">
    </div>
  </a>
  {% endif %}

  {% if show_banner_2 %}
  <a href="{{ APP_LINK }}" target="_blank" rel="noopener" class="promo-banner promo-banner--two-col">
    <img src="{{ SALE_ICON_URL }}" alt="Pre-Sale" class="promo-banner__sale-icon">
    <div class="promo-banner__right">
      <p class="promo-banner__line1"><strong>Get Flat 30% OFF</strong> exclusively on <strong>our app.</strong></p>
      <div class="promo-banner__line2">
        <div class="promo-banner__code-box">Use code: <strong>HEALTH30</strong></div>
        <span class="promo-banner__cta-btn">Get Early Access</span>
      </div>
    </div>
  </a>
  {% endif %}

  {% if show_banner_3 %}
  <a href="{{ ALL_PRODUCTS_LINK }}" class="promo-banner promo-banner--two-col promo-banner--sitewide">
    <img src="{{ SALE_ICON_URL }}" alt="Sale" class="promo-banner__sale-icon">
    <div class="promo-banner__right">
      <p class="promo-banner__line1"><strong>Get FLAT 30% OFF</strong> everything on our site.</p>
      <div class="promo-banner__line2">
        <div class="promo-banner__code-box promo-banner__code-box--full">Use code: <strong>HEALTH30</strong></div>
      </div>
    </div>
  </a>
  {% endif %}

</div>

<style>
  .promo-banner-wrapper {
    width: 100%;
    margin: 1rem 0;
    overflow: hidden;
  }

  .promo-banner {
    background: #DCEFE5;
    border-radius: 12px;
    padding: 10px 12px;
    width: 95%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    text-decoration: none;
    cursor: pointer;
    overflow: hidden;
    position: relative;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .promo-banner:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(35, 90, 73, 0.2);
  }

  .promo-banner::after {
    content: '';
    position: absolute;
    top: 0;
    left: -150%;
    width: 50%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
    animation: shimmer 2s infinite;
  }

  @keyframes shimmer {
    0% { left: -50%; }
    100% { left: 150%; }
  }

  @media (prefers-reduced-motion: reduce) {
    .promo-banner::after {
      animation: none;
    }
    .promo-banner:hover {
      transform: none;
    }
  }

  .promo-banner__line1 {
    margin: 0;
    font-size: 14px;
    color: #333;
    line-height: 1.3;
    text-align: center;
    white-space: nowrap;
  }

  .promo-banner__line1 strong {
    color: #1a1a1a;
    font-weight: 700;
  }

  /* Two column layout for banner 2 & 3 */
  .promo-banner--two-col {
    flex-direction: row;
    align-items: center;
    gap: 20px;
  }

  @media screen and (max-width: 768px) {
    .promo-banner {
      width: 100%;
    }
  }

  .promo-banner__sale-icon {
    width: 140px;
    height: auto;
    flex-shrink: 0;
  }

  .promo-banner__right {
    display: flex;
    flex-direction: column;
    gap: 6px;
    flex: 1;
  }

  .promo-banner--two-col .promo-banner__line1 {
    text-align: left;
    font-size: clamp(10px, 3vw, 16px);
  }

  .promo-banner--two-col .promo-banner__line2 {
    justify-content: flex-start;
  }

  .promo-banner__line2 {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .promo-banner__code-box {
    background: #F1F8F5;
    border: 2px dashed #235A49;
    border-radius: 5px;
    padding: 6px 14px;
    font-size: 12px;
    color: #333;
    white-space: nowrap;
  }

  .promo-banner__code-box strong {
    color: #1a1a1a;
    font-weight: 700;
  }

  .promo-banner__code-box--full {
    width: 100%;
    text-align: center;
  }

  .promo-banner__store-img {
    height: 32px;
    width: auto;
  }

  .promo-banner__cta-btn {
    background: #235A49;
    color: #EFE4B8;
    border-radius: 5px;
    padding: 7px 14px;
    font-size: 12px;
    font-weight: 600;
    white-space: nowrap;
  }

  @media screen and (max-width: 500px) {
    .promo-banner { padding: 8px 10px; gap: 5px; }
    .promo-banner--two-col { gap: clamp(8px, 3vw, 14px); }
    .promo-banner:not(.promo-banner--two-col) .promo-banner__line1 { font-size: clamp(8px, 2.8vw, 11px); }
    .promo-banner__sale-icon { width: clamp(60px, 25vw, 110px); }
    .promo-banner__right { gap: 4px; }
    .promo-banner__line2 { gap: clamp(4px, 1.5vw, 6px); }
    .promo-banner__code-box { padding: 5px 10px; font-size: 10px; border-width: 1.5px; }
    .promo-banner__store-img { height: clamp(18px, 6vw, 26px); }
    .promo-banner__cta-btn { padding: 5px 10px; font-size: 10px; }

    /* Banner 2 & 3: Force buttons to stay in single row with auto-scaling */
    .promo-banner--two-col .promo-banner__line1 {
      font-size: clamp(9px, 2.8vw, 14px);
      white-space: normal;
      line-height: 1.2;
    }
    .promo-banner--two-col .promo-banner__line2 {
      display: flex;
      flex-wrap: nowrap;
      width: 100%;
      gap: clamp(3px, 1.5vw, 6px);
    }
    .promo-banner--two-col .promo-banner__code-box {
      flex: 1;
      min-width: 0;
      text-align: center;
      padding: clamp(4px, 1.5vw, 8px) clamp(4px, 1.5vw, 8px);
      font-size: clamp(8px, 2.5vw, 12px);
    }
    .promo-banner--two-col .promo-banner__cta-btn {
      flex: 1;
      min-width: 0;
      text-align: center;
      padding: clamp(4px, 1.5vw, 8px) clamp(4px, 1.5vw, 8px);
      font-size: clamp(8px, 2.5vw, 12px);
    }
  }
</style>
